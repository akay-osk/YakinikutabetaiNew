<!DOCTYPE html>
<html lang="ja">
 <head>
   <meta charset="utf-8">
   <title>UserProfileEdit</title>
 </head>
 <body>
	
	<!--
		ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã™ã‚‹ãŸã‚ã®ãƒœã‚¿ãƒ³ã‚’ä½œæˆ
		
		[å‚è€ƒè³‡æ–™]
		https://magazine.techacademy.jp/magazine/25655
		https://www.sejuku.net/blog/65045
	-->
		
    <form id="form1">
      <input type="file" accept=".jpg,.jpeg,.png,.gif" id="file1"/>
      <br><br>
	  <input type="submit" value="ç”»åƒä¿å­˜" />
    </form>
	
	<!-- ğŸ”½ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ã‚’è¿½åŠ  -->
	<div id="previewArea"></div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

	<script>
	
		document.getElementById('file1').addEventListener('change', function () 
		{
	    	const file = this.files[0];

	    	if (!file) return;

	    	if (!file.type.startsWith('image/')) 
			{
	      		alert('ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
	      		return;
	    	}

	    	// ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
	    	const reader = new FileReader();
	    	reader.onload = function (e) 
			{
	      		const preview = document.getElementById('previewArea');
	      		preview.innerHTML = `<img src="${e.target.result}" width="300" alt="ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">`;
	   	 	};
	    		reader.readAsDataURL(file);
	  	});
		
		document.getElementById('form1').addEventListener('submit', async (event) => 
		{
			event.preventDefault();

			const fileInput = document.getElementById('file1');
			const file = fileInput.files[0];

			if (!file) 
			{
				alert('ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');
				return;
			}

			/*
			const reader = new FileReader();
			reader.onload = async function(e) 
			{
				const arrayBuffer = e.target.result;
				const uint8View = new Uint8Array(arrayBuffer);
				const base64String = btoa(String.fromCharCode(...uint8View));

				// Spring Bootã®APIã«POST
				const response = await fetch('/',
				{
					method: 'POST',
					headers: 
					{
						'Content-Type': 'application/json'
					},
					body: JSON.stringify({ image: base64String })
				});

				if (response.ok) 
				{
					alert('ç”»åƒã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
					
				} 
				else 
				{
					alert('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
				}
			};

			reader.readAsArrayBuffer(file);
			*/
		});
		
	</script>
</body>