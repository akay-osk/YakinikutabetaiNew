<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	
	<div th:with="title='NOT FOUNND'">
		<div th:replace="common :: common-head(${title})"></div>
	</div>
	<!-- 共通CSS -->
	<link th:href="@{/css/home.css}" rel="stylesheet" type="text/css">
	<link th:href="@{/css/MatchingNotFound.css}" rel="stylesheet" type="text/css">
</head>

<body>
	<section th:with="title='NOT MATCHING'">
			<header th:replace="common :: header(${title})"></header>


	<p>マッチングできませんでした...<br>マッチングまでしばらくお待ちください。</p>

	<form action="/retry" method="post">
	    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
	    <button type="submit" class="btn">条件を変更する</button>
	</form>
	
	<!-- ホームに戻るボタン　-->
	<a href="/home" class="btn" style="margin-left: 10px;">ホームに戻る</a>

	
	
	<fotter th:replace="common :: footer"></fotter>
</section>

	<script th:inline="javascript">
		const userId = /*[[${user_id}]]*/ 0;

		function checkMatchingStatus() {
			fetch(`/check-status?userId=${userId}`)
				.then(response => response.json())
				.then(data => {
					if (data.matched && data.roomId) {
						window.location.href = `/chatroom?room_id=${data.roomId}`;
					}
				})
				.catch(error => console.error("チェック失敗:", error));
		}

		// 5秒ごとに確認
		setInterval(checkMatchingStatus, 5000);
	</script>

</body>

</html>