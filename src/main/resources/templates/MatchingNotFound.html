<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="common.html :: common-head('マッチング待機中')">
</head>

<body>
	<div th:replace="common.html :: header('マッチング待機中')"></div>

	<p>現在待機中です...<br>マッチング成立までしばらくお待ちください。</p>

	<a href="/retry" class="btn">条件を変更する</a>

	<div th:replace="common.html :: footer"></div>

	<script th:inline="javascript">
		const userId = /*[[${user_id}]]*/ 0;

		function checkMatchingStatus() {
			fetch(`/check-status?userId=${userId}`)
				.then(response => response.json())
				.then(data => {
					if (data.matched && data.roomId) {
						window.location.href = `/Chatroom?room_id=${data.roomId}`;
					}
				})
				.catch(error => console.error("チェック失敗:", error));
		}

		// 5秒ごとに確認
		setInterval(checkMatchingStatus, 5000);
	</script>

</body>

</html>